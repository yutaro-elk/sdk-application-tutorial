# アプリケーションの目標

作成しているアプリケーションの目的は、ユーザーに名前を購入させ、それらの名前が解決する値を設定することです。指定された名前の所有者が現在の最高入札者になります。このセクションでは、これらの単純な要件がアプリケーション設計にどのように変換されるかを学びます。

ブロックチェーンアプリケーションは単なる[複製された確定的ステートマシン](https://en.wikipedia.org/wiki/State_machine_replication)です。開発者としては、ステートマシン(つまり、状態、開始状態、および状態遷移をトリガーするメッセージ)と[*Tendermint*](https://tendermint.com/docs/introduction/introduction)を定義するだけです。 html)はあなたのためにネットワーク上で複製を処理します。

> Tendermintは、あなたのブロックチェーンの*ネットワーク*と*コンセンサス*の処理を担当するアプリケーションにとらわれないエンジンです。実際には、これはTendermintがトランザクションバイトの伝播と順序付けに責任があることを意味します。 Tendermint Coreは、取引の順序について合意に達するために、同名のビザンチンフォールトトレラント(BFT)アルゴリズムに依存しています。 Tendermintの詳細については、[ここ](https://tendermint.com/docs/introduction/introduction.html)をクリックしてください。

[Cosmos SDK](https://github.com/cosmos/cosmos-sdk/)は、ステートマシンの構築を支援するように設計されています。 SDKは**モジュラーフレームワーク**です。つまり、相互運用可能なモジュールを集めてアプリケーションを構築するということです。各モジュールには独自のメッセージ/トランザクションプロセッサが含まれ、SDKは各メッセージをそれぞれのモジュールにルーティングします。

これは、ネームサービスアプリケーションに必要なモジュールです。
 - `auth`：このモジュールはアカウントと料金を定義し、あなたのアプリケーションの残りにこれらの機能へのアクセスを与えます。
 - `bank`：このモジュールはアプリケーションがトークンとトークン残高を作成し管理することを可能にします。
 - `nameservice`：このモジュールはまだ存在しません！それはあなたが構築している`nameservice`アプリケーションのためのコアロジックを処理します。それはあなたのアプリケーションを構築するために取り組まなければならないソフトウェアの主要な部分です。

>バリデータセットの変更を処理するモジュールがないのはなぜだろうと疑問に思うかもしれません。実際、Tendermintは、ブロックチェーンに追加する次の有効なトランザクションブロックについて[合意に達する](https://tendermint.com/docs/introduction/introduction.html#consensus-overview)するために一連のバリデータに依存しています。デフォルトでは、どのバリデータセットもバリデータセットの変更を処理しない場合、バリデータセットはジェネシスファイル`genesis.json`で定義されているものと同じままになります。これがこのアプリケーションの場合です。アプリケーションのバリデータセットの変更を許可したい場合は、SDKの[ステークモジュール](https://github.com/cosmos/cosmos-sdk/tree/master/x/staking)を使用できます。自分で書いてください。

それでは、アプリケーションの2つの主要部分、状態とメッセージタイプを見てみましょう。

## ステイト(状態)

状態は特定の時点におけるアプリケーションを表します。それは、各アカウントが所有するトークンの量、各名前の所有者と価格、そして各名前がどのような価値に解決されるかを示します。

トークンとアカウントの状態は`auth`と`bank`モジュールによって定義されています。これは今のところ自分で気にする必要がないことを意味します。あなたがする必要があるのはあなたの`nameservice`モジュールに特に関連する状態の部分を定義することです。

SDKでは、すべてが`multistore`と呼ばれる1つのストアに格納されています。このマルチストアには、任意の数のキー/値ストア(Cosmos SDKでは[`KVStores`](https://godoc.org/github.com/cosmos/cosmos-sdk/types#KVStoreと呼ばれる)を作成できます。このアプリケーションでは、1つのストアを使用して、「名前」をそれぞれの「whois」(名前の値、所有者、および価格を保持する構造体)にマッピングします。

## メッセージ

メッセージはトランザクションに含まれています。それらは状態遷移を引き起こします。各モジュールはメッセージのリストとその処理方法を定義します。以下は、ネームサービスアプリケーションに必要な機能を実装するために必要なメッセージです。

 - `MsgSetName`：このメッセージは名前の所有者が与えられた名前に値を設定することを可能にします。
 - `MsgBuyName`：このメッセージはアカウントが名前を購入してその所有者になることを可能にします。
   - 誰かが名前を買うとき、彼らはその名前の前の所有者に前の所有者がそれに対して支払った価格より高い価格を支払うことを要求される。名前に以前の所有者がまだいない場合、彼らは`MinPrice`の額を燃やす必要があります。

トランザクション(ブロックに含まれる)がTendermintノードに達すると、それは[ABCI](https://github.com/tendermint/tendermint/tree/master/abci)を介してアプリケーションに渡され、メッセージを取得するためにデコードされます。 。メッセージはその後適切なモジュールにルーティングされ、`Handler`で定義されたロジックに従ってそこで処理されます。状態を更新する必要がある場合、`Handler`は更新を実行するために`Keeper`を呼び出します。このチュートリアルの次のステップで、これらの概念について詳しく学びます。

### アプリケーションがどのように機能するかを高レベルの観点から決定したので、今度は[実装を開始します](02_app-init.md)です。